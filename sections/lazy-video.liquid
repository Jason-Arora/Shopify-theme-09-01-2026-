{% schema %}
{
  "name": "Lazy YouTube Video",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "youtube_id",
      "label": "YouTube Video ID",
      "default": "dQw4w9WgXcQ"
    },
    {
      "type": "image_picker",
      "id": "thumbnail_image",
      "label": "Thumbnail Image (optional)"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Watch Our Video"
    },
    {
      "type": "textarea",
      "id": "paragraph",
      "label": "Paragraph Text",
      "default": "Learn more about our services and how we can help you grow."
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    }
  ],
  "presets": [
    {
      "name": "Lazy Video with Text",
      "category": "Media"
    }
  ]
}
{% endschema %}

<section class="lazy-video-split" style="padding: 2rem 1rem;">
  <div class="lazy_load_inner" style="max-width: 1200px; margin: 0 auto; display: flex; flex-wrap: wrap; gap: 2rem; align-items: center;">
    <!-- Left: Video -->
    <div class="lazy-youtube-wrapper" data-youtube-id="{{ section.settings.youtube_id }}" style="flex: 1 1 500px; min-width: 300px; position: relative; cursor: pointer; aspect-ratio: 16 / 9;">
      <img
        src="{% if section.settings.thumbnail_image != blank %}{{ section.settings.thumbnail_image | img_url: '720x' }}{% else %}https://img.youtube.com/vi/{{ section.settings.youtube_id }}/hqdefault.jpg{% endif %}"
        alt="YouTube thumbnail"
        style="width: 100%; height: 100%; object-fit: cover; display: block;"
        loading="lazy"
      />
      <!--div class="play-button" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:3rem;color:white;text-shadow:0 0 5px black;">▶️</div-->
    </div>

    <!-- Right: Text and Button -->
    <div class="video-text-content" style="flex: 1 1 400px; min-width: 280px;">
      <h2 style="margin-bottom: 1rem;">{{ section.settings.heading }}</h2>
      <p style="margin-bottom: 1.5rem;">{{ section.settings.paragraph }}</p>
      {% if section.settings.button_label != blank and section.settings.button_link != blank %}
        <a href="{{ section.settings.button_link }}" class="btn" style="display:inline-block; padding: 0.75rem 1.5rem; background:#000; color:#fff; text-decoration:none; border-radius: 5px;">
          {{ section.settings.button_label }}
        </a>
      {% endif %}
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.lazy-youtube-wrapper').forEach(function(wrapper) {
      wrapper.addEventListener('click', function () {
        const youtubeId = wrapper.getAttribute('data-youtube-id');
        const iframe = document.createElement('iframe');
        iframe.setAttribute('src', 'https://www.youtube.com/embed/' + youtubeId + '?autoplay=1');
        iframe.setAttribute('frameborder', '0');
        iframe.setAttribute('allowfullscreen', '1');
        iframe.setAttribute('allow', 'autoplay; encrypted-media');
        iframe.style.width = '100%';
        iframe.style.height = '100%';

        wrapper.innerHTML = '';
        wrapper.appendChild(iframe);
      });
    });
  });
</script>
